import{r as d,j as e,G,S as M}from"./app-D3o4_Csc.js";import{A as L}from"./AuthenticatedLayout-BH5NEpFD.js";import{I as r}from"./InputError-D7UQ5kee.js";import{I as l}from"./InputLabel-CJ12VTUu.js";import{T as c}from"./TextInput-DMdyDCWq.js";import{C as K}from"./Checkbox-BbFPKuRw.js";import"./Dropdown-ByiV9sxw.js";import"./transition-DhB3eRDt.js";const b=d.forwardRef(function({className:m="",children:o,isFocused:u=!1,...s},a){const h=a||d.useRef();return d.useEffect(()=>{u&&h.current.focus()},[]),e.jsx("select",{...s,className:"border-gray-300 focus:border-red-500 focus:ring-red-500 rounded-md shadow-sm "+m,ref:h,children:o})});function Q({auth:f,assets:m=[]}){const[o,u]=d.useState(1),{data:s,setData:a,post:h,processing:y,errors:n}=G({visit_date:"",visit_time_start:"",visit_time_end:"",building_type:"",building_category:"",agenda:"",meet_with:"",notes:"",phone:"",email:"",agreement:!1}),[g,N]=d.useState(""),[_,x]=d.useState([]),[w,k]=d.useState(null),[S,p]=d.useState(!1),[j,C]=d.useState([]);d.useEffect(()=>{g.length>0?fetch(`/api/pics?search=${g}`).then(t=>t.json()).then(t=>x(t)):x([])},[g]);const A=()=>{u(o+1)},P=()=>{u(o-1)},I=t=>{t.preventDefault();const i=[];if((!s.phone||s.phone.trim()==="")&&i.push("Tolong isi nomor telepon anda"),(!s.visit_date||s.visit_date.trim()==="")&&i.push("Tolong isi tanggal kunjungan"),(!s.visit_time_end||s.visit_time_end.trim()==="")&&i.push("Tolong isi jam selesai kunjungan"),(!s.visit_time_start||s.visit_time_start.trim()==="")&&i.push("Tolong isi jam mulai kunjungan"),(!s.agenda||s.agenda.trim()==="")&&i.push("Tolong isi agenda kunjungan"),(!s.email||s.email.trim()==="")&&i.push("Tolong isi Nama PIC"),(!s.building_type||s.building_type.trim()==="")&&i.push("Tolong isi tipe bangunan"),(!s.email||s.email.trim()==="")&&i.push("Tolong isi email anda"),s.agreement||i.push("Anda harus menyetujui persyaratan"),i.length>0){alert(i.join(`
`));return}h(route("visits.store"),{onSuccess:()=>{console.log("Success submitting data"),window.location=route("visits.index")},onError:v=>{console.error("Error submitting data:",v)},preserveScroll:!0})},T=t=>{C(i=>i.includes(t)?i.filter(v=>v!==t):[...i,t])},E=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"visit_date",value:"Tanggal Kunjungan"}),e.jsx(c,{id:"visit_date",name:"visit_date",type:"date",value:s.visit_date,onChange:t=>a("visit_date",t.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(r,{message:n.visit_date,className:"mt-1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"visit_time_start",value:"Dari"}),e.jsx(c,{id:"visit_time_start",name:"visit_time_start",type:"time",value:s.visit_time_start,onChange:t=>a("visit_time_start",t.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(r,{message:n.visit_time_start,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"visit_time_end",value:"Sampai"}),e.jsx(c,{id:"visit_time_end",name:"visit_time_end",type:"time",value:s.visit_time_end,onChange:t=>a("visit_time_end",t.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(r,{message:n.visit_time_end,className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"building_type",value:"Jenis Gedung"}),e.jsxs(b,{id:"building_type",name:"building_type",value:s.building_type,onChange:t=>a("building_type",t.target.value),className:"mt-1 block w-full",children:[e.jsx("option",{value:"",children:"Pilih Jenis Gedung"}),e.jsx("option",{value:"Plant",children:"Plant"}),e.jsx("option",{value:"Office",children:"Office"}),e.jsx("option",{value:"Workshop",children:"Workshop"})]}),e.jsx(r,{message:n.building_type,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"building_category",value:"Kategori Gedung"}),e.jsxs(b,{id:"building_category",name:"building_category",value:s.building_category,onChange:t=>a("building_category",t.target.value),className:"mt-1 block w-full",children:[e.jsx("option",{value:"",children:"Pilih Kategori Gedung"}),e.jsx("option",{value:"Restricted",children:"Restricted"}),e.jsx("option",{value:"Semi-Restricted",children:"Semi-Restricted"}),e.jsx("option",{value:"Non-Restricted",children:"Non-Restricted"})]}),e.jsx(r,{message:n.building_category,className:"mt-1"})]})]}),O=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"agenda",value:"Agenda"}),e.jsxs(b,{id:"agenda",name:"agenda",value:s.agenda,onChange:t=>a("agenda",t.target.value),className:"mt-1 block w-full",children:[e.jsx("option",{value:"",children:"Pilih Agenda"}),e.jsx("option",{value:"Meeting",children:"Meeting"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"}),e.jsx("option",{value:"Audit",children:"Audit"}),e.jsx("option",{value:"Others",children:"Others"})]}),e.jsx(r,{message:n.agenda,className:"mt-1"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{htmlFor:"meet_with",value:"Bertemu Dengan (PIC)"}),e.jsx(c,{id:"meet_with",name:"meet_with",value:g,onChange:t=>{N(t.target.value),k(null),a("meet_with",t.target.value)},type:"text",className:"mt-1 block w-full",placeholder:"Nama PIC",autoComplete:"off"}),_.length>0&&e.jsx("ul",{className:"absolute left-0 right-0 bg-white border rounded shadow z-20 max-h-48 overflow-y-auto",children:_.map(t=>e.jsxs("li",{className:"p-2 hover:bg-gray-200 cursor-pointer",onClick:()=>{k(t),N(t.nama),a("meet_with",t.nama),a("pic_id",t.id),x([])},children:[t.nama," (",t.email,")"]},t.id))}),e.jsx("input",{type:"hidden",name:"pic_id",value:w?w.id:""}),e.jsx(r,{message:n.meet_with,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"notes",value:"Catatan (Opsional)"}),e.jsx("textarea",{id:"notes",name:"notes",value:s.notes,onChange:t=>a("notes",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",rows:4}),e.jsx(r,{message:n.notes,className:"mt-1"})]})]}),R=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Pilih Aset yang Dibawa"}),e.jsx("p",{className:"text-gray-600",children:"Silakan pilih aset yang akan Anda bawa saat kunjungan. Jika belum ada, tambahkan aset terlebih dahulu."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",className:"inline-flex items-center px-6 py-3 bg-white border border-red-500 text-red-600 rounded-lg font-semibold shadow hover:bg-red-50 transition",onClick:()=>p(!0),children:"+ Tambah Aset"})}),j.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Aset Terpilih:"}),e.jsx("ul",{className:"list-disc ml-6",children:m.filter(t=>j.includes(t.id)).map(t=>e.jsxs("li",{children:[t.name," (",t.category,") - ",t.code]},t.id))})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Pilih Aset"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:m.length===0?e.jsx("div",{className:"text-gray-500",children:"Belum ada aset."}):m.map(t=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:j.includes(t.id),onChange:()=>T(t.id)}),e.jsxs("span",{children:[t.name," (",t.category,") - ",t.code]})]},t.id))}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition font-semibold",children:"Simpan Pilihan"})})]})]})})]}),F=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Info Pribadi"}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"phone",value:"No Telepon Saya"}),e.jsx(c,{id:"phone",type:"tel",value:s.phone,onChange:t=>a("phone",t.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(r,{message:n.phone,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email",value:"Email Saya"}),e.jsx(c,{id:"email",type:"email",value:s.email,onChange:t=>a("email",t.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(r,{message:n.email,className:"mt-1"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"flex items-start",children:[e.jsx(K,{name:"agreement",checked:s.agreement,onChange:t=>a("agreement",t.target.checked)}),e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["Saya menyatakan bahwa:",e.jsx("br",{}),"1. Saya tidak bepergian dan tidak melakukan kontak tatap muka dengan seorang dari negara endemik virus corona (Covid 19) dalam kurun waktu 14 hari terakhir",e.jsx("br",{}),"2. Saya bersedia mengikuti setiap aturan, K3 dan Safety Induction yang sudah saya baca dan tonton di awal pendaftaran yang berlaku di PLTU BOSOWA ENERGI selama bertamu dan bekerja di wilayah kerja PLTU BOSOWA ENERGI",e.jsx("br",{}),"3. Saya bersedia mematuhi HSE yang berlaku di PLTU BOSOWA ENERGI"]})]}),e.jsx(r,{message:n.agreement,className:"mt-1"})]})]}),B=()=>{switch(o){case 1:return E();case 2:return O();case 3:return R();case 4:return F();default:return null}};return e.jsxs(L,{user:f.user,children:[e.jsx(M,{title:"Buat Kunjungan Baru"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:I,children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex justify-between mb-2",children:[1,2,3,4].map(t=>e.jsx("div",{className:`w-1/4 h-2 ${t<=o?"bg-red-600":"bg-gray-200"}`},t))})}),B(),e.jsxs("div",{className:"mt-6 flex justify-between",children:[o>1&&e.jsx("button",{type:"button",onClick:P,className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150",children:"Kembali"}),o<4?e.jsx("button",{disabled:y||!s,type:"button",onClick:A,className:"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 focus:bg-red-700 active:bg-red-900 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150",children:"Selanjutnya"}):e.jsx("button",{type:"submit",disabled:y||!s.agreement,className:"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 focus:bg-red-700 active:bg-red-900 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150 disabled:opacity-25",children:"Submit"})]})]})})})})})]})}export{Q as default};
